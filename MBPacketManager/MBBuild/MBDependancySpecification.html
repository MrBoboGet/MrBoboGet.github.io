<!DOCTYPE html><html><head><style>body{background-color: black; color: #00FF00;}</style></head><body><div style="display: flex"><div style="width: 30%; display: inline-block"><details open=""><summary><a href="../../index.html">/</a></summary><ul><li><a href="../../index.html" >index.mbd</a></li><li><details><summary><a href="../../MBCC/index.html">MBCC</a></summary><ul><li><a href="../../MBCC/index.html" >index.mbd</a></li><li><a href="../../MBCC/CLI.html" >CLI.mbd</a></li><li><a href="../../MBCC/History.html" >History.mbd</a></li></ul></details></li><li><details><summary><a href="../../MBDoc/index.html">MBDoc</a></summary><ul><li><a href="../../MBDoc/index.html" >index.mbd</a></li><li><a href="../../MBDoc/History.html" >History.mbd</a></li><li><a href="../../MBDoc/BuildPipeline.html" >BuildPipeline.mbd</a></li><li><a href="../../MBDoc/Building.html" >Building.mbd</a></li><li><a href="../../MBDoc/Format.html" >Format.mbd</a></li><li><a href="../../MBDoc/Attributes.html" >Attributes.mbd</a></li><li><a href="../../MBDoc/LinkResolving.html" >LinkResolving.mbd</a></li><li><a href="../../MBDoc/CodeIndex.html" >CodeIndex.mbd</a></li><li><a href="../../MBDoc/CLI.html" >CLI.mbd</a></li><li><details><summary><a href="../../MBDoc/Compiler/index.html">Compiler</a></summary><ul><li><a href="../../MBDoc/Compiler/index.html" >index.mbd</a></li></ul></details></li></ul></details></li><li><details open=""><summary><a href="../index.html">MBPacketManager</a></summary><ul><li><a href="../index.html" >index.mbd</a></li><li><a href="../CLI.html" >CLI.mbd</a></li><li><a href="../DevelopmentStructure.html" >DevelopmentStructure.mbd</a></li><li><a href="../Packets.html" >Packets.mbd</a></li><li><a href="../PacketsSpecification.html" >PacketsSpecification.mbd</a></li><li><a href="../SubPackets.html" >SubPackets.mbd</a></li><li><a href="../Extensions.html" >Extensions.mbd</a></li><li><a href="../Terminology.html" >Terminology.mbd</a></li><li><a href="../History.html" >History.mbd</a></li><li><details open=""><summary><a href="index.html">MBBuild</a></summary><ul><li><a href="index.html" >index.mbd</a></li><li><a href="History.html" >History.mbd</a></li><li><a href="Buildsystem.html" >Buildsystem.mbd</a></li><li><a href="MBCompileConfigurations.html" >MBCompileConfigurations.mbd</a></li><li><mark><a href="" >MBDependancySpecification.mbd</a></mark></li><li><a href="MBSourceInfo.html" >MBSourceInfo.mbd</a></li><li><a href="CLI.html" >CLI.mbd</a></li></ul></details></li></ul></details></li></ul></details></div><div style="width: 80ch; display: inline-block; position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: auto;"><h1 style="text-align: center;">MBDependancySpecification</h1>
MBBuild doesn't allow the packets themselves to determine which compile configurations are valid for the packet, and also which compile configurations are valid for that packets dependancies. Idomatic usage of mbpm is to compile a packet and all of it's dependancies with the same configuration, which is guaranteed to produce compatible libraries, but this also means that having many configurations may result in excessive recompilations of libraries. There also exists libraries that have extremly large compilation times, and depending on such libraries should not require to recompile them for every change in compilation configuration.  <br><br>

This leads to the "DependancySpecification", which is serialised and stored in  "$MBPM_PACKETS_INSTALL_DIRECTORY/Extensions/MBBuild/MBDependancySpecification.json". <br><br>

A dependancy specification specifies, for all compilations, which compile configuration it should link against for each of it's dependancies. <br><br>

<h1 id="Global dependancy specification" style = "text-align: center;">1 Global dependancy specification</h1><br>
    A compilation with MBBuild always requires a DependancySpecification, and unless     overriden, will always use the the global configuration located at     "$MBPM_PACKETS_INSTALL_DIRECTORY/Extensions/MBBuild/MBDependancySpecification.json". <br><br>

    This file not existing is not treated as an error, which means that the      the empty specification is assumed, which is equivalent to a dependancy     specification on the form <br><br>

<pre>{
    "Specifications":[]
}</pre>    This in practice means that the compilation links against the same     configuration for all of the dependancies. <br><br>

<h1 id="Local dependancy specification" style = "text-align: center;">2 Local dependancy specification</h1><br>
    When invoking the compilation process so is it possible to override the     dependancy specification used, more about how to invoke MBBuild can be found     <a href="CLI.html">here</a>. <br><br>

    This functionality is intended to support cases where an uncommon niche     situation is encountered, where the exact compile configurations for all the     dependancies are known and needed. It is therefore assumed that this doesn't     need frequent recompilations.  <br><br>

    This can also be used when compiling code that isn't integrated into the     MBBuild system, where an adhoc solution is needed. <br><br>

<mark>Note: </mark>    Overrding the build specification this way for packets which are under the     control of mbpm is not recommended. As the specific configurations are     stored and compared during each compilation for need of relinking,     conflicting dependancy specifications will result in a relinking of each     target. <br><br>

<h1 id="MBDependancySpecification.json" style = "text-align: center;">3 MBDependancySpecification.json</h1><br>
    Following the philosophy of MBBuild, so is the dependancy specification not     intended to provide a turing complete or extremly powerful  way to specify     dependancies, instead aiming for a simple, human readable and editable     format. <br><br>

<h2 id="Overview" >3.1 Overview</h2><br>
        The specification file is written in JSON format, and consists of an         array of specifications. Each specification consists of a number of         predicates. All predicates evaluating to true means that the given         result configuration is used in when linking to that dependancy. <br><br>

        The conditions present in the "Predicates" field can therefore be seen         as connected with a "AND" condition, and having multiple Specifications         with the same ResultConfiguration can therefore be used in creating "OR"         conditions for a specific "ResultConfiguration". <br><br>

        A dependancy not satisfying any "Specification" will use the same         configuration as the current compilation. <br><br>

<h2 id="Rationale" >3.2 Rationale</h2><br>
        The peculiar format used to describe the dependancy specification comes         from a couple of restrictions and assumptions made about the usage of         the dependancy specification. <br><br>

        The most important restriction, is that only attributes available          from the packets <a href="../Packets.html#MBPM_PacketInfo">PacketInfo</a> can be         used. Depending on specific files to be present/not present or similar         is brittle, it can change with updates to the packet files, and rarely         enables a generic solution. The predicates are checked against <i>all</i>         dependancies, and writing a complicated predicate to ensure that a         specific packet always uses a specific configuration is never needed, as         one can always just add that specific name to the desired specification,         or create new one. <br><br>

        Whenever a user knows that a specific packet needs special care so are         these simple predicates sufficient, but complex predicates rarely allows         a user to catch cases where packets they don't know about need special         care, simply because they don't know about them they can't possibly be         expected to know wheter their predicate correctly handles that packet. <br><br>

        Group of packets that should have the same considerations can therefore         be handled with packet attributes. Attributes provide a way to for users         and distributors to specify semantics of a packet that are meant to be         interpreted and by the user and used ineractivly. Having for example all         of the packets which take a long time to compile labeled "Big" can         provide a crude, but often times sufficient, way to handle these cases. <br><br>

        Another important restriction, is that the dependancy specification is         not allowed to have any arbitrary code execution. One should be able to         share the dependancy specification with other users on order to for         example identify an error with the build process, and allowing the         dependancy specifiaciton to be arbitraily complex harms the ability for         other users to understands ones configuration. <br><br>

<h2 id="Fields and semantics" >3.3 Fields and semantics</h2><br>
        The dependancy specification is a JSON object consisting of exactly one         field, the "Specifications" field. This field is an array of          <a href="#Specification">specifications</a>. Every         <a href="#Specification">specification</a> defines a rule that determines if a         dependancy should use another compile configuration. <br><br>

        A packet may satisfy multiple Specifications, but only the first         specification satisfied is used in determining which configuration is         used. <br><br>

<h3 id="Specification" >3.3.1 Specification</h3><br>
            A specification is a JSON object that has 2 mandatory fields, the              "Predicates" field and the "ResultConfiguration". The predicate             fields describe the predicates used to determine wheter or not a             packet should use this specifications. A packet has to satisfy all             predicates in order to satisfy the whole specification. A packet             satisfying a Specification uses compile configuration in the             "ResultConfiguration" field, which means that "ResultConfiguration"             has to be a string. <br><br>

<h4 id="Predicate" >3.3.1.1 Predicate</h4><br>
                A predicate consists of only optional fields. Each field is an                 array of strings, which are checked against fields in the                  <a href="../Packets.html#MBPM_PacketInfo">packet info</a>. A matching field                 means that the predicate is satisfied, and only one type of                 field has to be satsified for the whole predicate to be                 satisfied, not all at once. <br><br>

                A predicate also has a special field "Negatad", which is a                 boolean. It defaults to false, but setting it to true means that                 a predicate not being satisfied by a packet is now treated as                 the satisfying condition, and a predicate being satisfied by a                 packet is then treated as not being satisfied, functioning                 exacly as a logical negation. <br><br>

<h5 id="PacketName" >3.3.1.1.1 PacketName</h5><br>
                    PacketName is an array of strings. The default value is an                     empty array, meaning that no packet can satisfy this                     condition. <br><br>

                    Every string in PacketName is compared against the                      <a href="../Packets.html#PacketName">PacketName</a> of the packet, and                     if any of the strings match the packet name, so is the                     predicate satisfied. <br><br>

<h5 id="Attribute" >3.3.1.1.2 Attribute</h5><br>
                    Attribute is an array of strings. The default value is an                     empty array, meaning that no packet can satsify this                     condition. <br><br>

                    Every string in the array is compared against every                     string in the <a href="../Packets.html#Attributes">Attributes</a> field                     of the <a href="../Packets.html#MBPM_PacketInfo">packet info</a>, and                     if any strings match the predicate is satisfied. <br><br>

<h5 id="ConfigurationName" >3.3.1.1.3 ConfigurationName</h5><br>
                    ConfigurationName is an array of strings. The default value                     is an empty array, meaning that no packet can satsify this                     condition. <br><br>

                    Every string in the array is checked against the compile                     configuration during the current compilation, and if any                     string match the predicate is satisfied. <br><br>

<h5 id="Negated" >3.3.1.1.4 Negated</h5><br>
                    Negated is a boolean. The default values is false. <br><br>

                    Negated being true means that any packet satsifying the                     predciate now doesn't satisfy it, and any packet not                     satisfying the predicate now satisfy the predicate. <br><br>

<h1 id="Examples" style = "text-align: center;">4 Examples</h1><br>
This dependancy specification has 1 specification, that in turn has 2 predicates. This specification can therefore only change the linked to configuration to one possibly different compile configuration, namely "Release". The first predicate is true for all packets that has the attribute "NonMBBuild", and the second predicate is true whenever the compile configuration isn't  "Debug" or "Release". <br><br>

This configuration can for example be used when all packets with the "NonMBBuild" attribute take a long time to compile, but a good debug experience is still required. These packets only need to be compiled for 2 configurations, "Release" and "Debug". <br><br>

<pre>{
    "Specifications":
        [
            {
                "Predicates":
                    [
                        {
                            "PacketName":[],
                            "Attribute":["NonMBBuild"],
                            "ConfigurationName":[]
                        },
                        {
                            "Negated": true,
                            "ConfigurationName":["Debug","Release"]
                        }
                    ],
                    "ResultConfiguration":"Release"
            }
        ]
}</pre></div></div></body></html>